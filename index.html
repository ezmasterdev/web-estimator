<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>âœ¨ Professional Web Dev Price Estimator</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
body { 
    background-color: #f4f7f6; 
    padding: 40px; 
    min-height: 100vh;
}
.calculator { 
    max-width: 1100px; 
    margin: auto; 
    background-color: #fff; 
    padding: 30px; 
    border-radius: 12px; 
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); 
}
.card-input { border-left: 5px solid #007bff; }
.result-box { 
    font-size: 2rem; 
    font-weight: bold; 
    text-align: center; 
    padding: 20px; 
    background-color: #d1ecf1; 
    color: #0c5460; 
    border-radius: 8px; 
    border: 1px solid #bee5eb; 
    margin-bottom: 20px;
}
canvas { 
    max-height: 350px; 
    width: 100%; 
}
#initialPlaceholder {
    min-height: 350px;
    text-align: center;
    padding: 40px;
    border: 2px dashed #ccc;
    border-radius: 8px;
    color: #6c757d;
    background-color: #e9ecef;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.chart-legend-item {
    display: flex;
    align-items: center;
    margin-bottom: 5px;
}
.chart-legend-color {
    display: inline-block;
    width: 15px;
    height: 15px;
    margin-right: 8px;
    border-radius: 3px;
}
.desc {
    font-size: 0.85rem;
    color: #6c757d;
    margin-top: 3px;
}
/* New style for PDF elements - ensure they are visible for html2canvas */
.pdf-table-styles {
    width: 190mm; /* Sizing for A4 */
    margin: 10px;
}
.pdf-table-styles th, .pdf-table-styles td {
    padding: 8px;
    border: 1px solid #dee2e6;
}
.pdf-table-styles th {
    background-color: #f8f9fa;
    text-align: left;
}
/* New style for modal tables */
.modal-pricing-table th, .modal-pricing-table td {
    vertical-align: middle;
}

/* Floating Button Styles */
#discountButton {
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 1050; /* Above regular content, below modals */
    padding: 15px 20px;
    border-radius: 50px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    font-weight: bold;
}

/* Added a class for discount checkboxes for easy targeting/styling if needed */
.discount-check:checked {
    border-color: #ffc107;
    background-color: #ffc107;
}
</style>
</head>

<body>

<div class="calculator">
    <h1 class="mb-4 text-center text-primary">
        EZ Web Development Price Estimator ðŸ’°
        <button type="button" class="btn btn-link p-0 m-0 align-top" 
                data-bs-toggle="modal" data-bs-target="#pricingModal" title="Show Detailed Pricing Structure">
            <i class="bi bi-question-circle-fill fs-5 text-secondary"></i>
        </button>
    </h1>
    <p class="text-center text-muted mb-5">Select your project type and features to get an estimated cost breakdown.</p>

    <div class="mb-4 text-center">
        <label class="fw-bold">Client Type</label>
        <select id="clientType" class="form-select w-50 mx-auto">
            <option value="local" selected>Local Client</option>
            <option value="foreign">Foreign Client</option>
        </select>
    </div>

    <div class="row mb-4">
        <div class="col-md-5 mx-auto">
            <div class="card card-input p-4 text-center">
                <h3 class="card-title text-primary"><i class="bi bi-gear-fill"></i> Project Scope</h3>
                <div class="mb-3">
                    <label class="form-label fw-bold">Site Type</label>
                    <p class="text-muted small">Choose whether the project is static or dynamic.</p>
                    <select class="form-select w-75 mx-auto" id="siteType">
                        <option value="" disabled selected>Select site type</option>
                        <option value="static">Static</option>
                        <option value="dynamic">Dynamic</option>
                    </select>
                </div>

                <div class="mb-3" id="numPagesContainer" style="display:none;">
                    <label class="form-label fw-bold">Number of Pages</label>
                    <p class="text-muted small">Total number of unique pages the website will have.</p>
                    <input type="number" id="numPages" class="form-control w-50 mx-auto text-center" min="1" value="5">
                </div>
            </div>
        </div>

        <div class="col-md-7 mx-auto" id="dynamicInputs" style="display:none;">
            <div class="card card-input p-4 text-center">
                <h3 class="card-title text-success"><i class="bi bi-server"></i> Dynamic Features</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Database Tables</label>
                        <input type="number" id="numTables" class="form-control w-50 mx-auto text-center" min="1" value="5">
                        <p class="text-muted small">Number of data structures your system will store (users, orders, etc.)</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">User Roles</label>
                        <input type="number" id="numRoles" class="form-control w-50 mx-auto text-center" min="1" value="1">
                        <p class="text-muted small">Different types of users with unique permissions.</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">External Notifications</label>
                        <input type="number" id="numExternalNotifs" class="form-control w-50 mx-auto text-center" min="0" value="0">
                        <p class="text-muted small">Integrations like SMS, email alerts, or third-party notifications.</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Payment Gateways</label>
                        <input type="number" id="numGateways" class="form-control w-50 mx-auto text-center" min="0" value="0">
                        <p class="text-muted small">Online payment methods (e.g., GCash, PayPal, Credit Card).</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center mb-5">
        <button class="btn btn-primary btn-lg w-75 mb-3" onclick="calculatePrice(false)">
            <i class="bi bi-calculator"></i> Calculate
        </button>

        <button class="btn btn-secondary btn-lg w-75 mb-3" onclick="resetEstimator()">
            <i class="bi bi-arrow-clockwise"></i> Reset
        </button>

        <button class="btn btn-danger btn-lg w-75" onclick="generatePDF()">
            <i class="bi bi-filetype-pdf"></i> Download PDF Report
        </button>
    </div>

    <hr/>

    <div class="row">
        <div class="col-md-6">
            <div class="result-box" id="resultTotal">Estimated Price: â‚±0</div>
            <ul class="list-group" id="breakdown">
                <li class="list-group-item text-center text-muted">Waiting for input...</li>
            </ul>
        </div>

        <div class="col-md-6">
            <div id="initialPlaceholder">
                <i class="bi bi-pie-chart display-1"></i>
                <p class="mt-3 fs-5 fw-bold">Price Breakdown Chart Awaiting Input</p>
            </div>

            <div id="chartDisplayContainer" style="display:none;">
                <canvas id="priceChart"></canvas>
                <ul id="customLegend" class="list-unstyled mt-4 d-flex flex-wrap justify-content-center"></ul>
            </div>
        </div>
    </div>
</div>

<div id="pdf-table-container" style="position: absolute; left: -9999px;">
    <table id="pdf-breakdown-table" class="pdf-table-styles table table-striped"></table>
</div>

<!-- Pricing Modal -->
<div class="modal fade" id="pricingModal" tabindex="-1" aria-labelledby="pricingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="pricingModalLabel"><i class="bi bi-info-circle"></i> Detailed Pricing Logic</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p class="lead">The estimation is calculated based on the following fixed and unit costs:</p>
                <div id="pricingDetailsContent"></div>
                <hr>
                <div class="alert alert-info" role="alert">
                    <h4 class="alert-heading">Client Type Multiplier</h4>
                    <p>The total cost is multiplied by a factor of <strong>2</strong> for <strong>Foreign Clients</strong> to account for time-zone differences, increased communication complexity, and international billing standards.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Discount Modal -->
<div class="modal fade" id="discountModal" tabindex="-1" aria-labelledby="discountModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title" id="discountModalLabel"><i class="bi bi-percent"></i> Tailored Discount Calculator</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="basePriceInput" class="form-label fw-bold">Estimated Total Price (â‚±)</label>
                    <input type="number" id="basePriceInput" class="form-control form-control-lg text-end" placeholder="Enter Base Price" min="0" value="0" oninput="calculateDiscounts()">
                    <div class="form-text">**Note:** This is the base price from the main calculator or a custom estimate.</div>
                </div>

                <h6 class="mt-4 border-bottom pb-2"><i class="bi bi-tags-fill"></i> Applicable Discounts</h6>

                <div class="form-check mb-2">
                    <input class="form-check-input discount-check" type="checkbox" id="referralDiscount" onchange="handleDiscountCheckbox(this)">
                    <label class="form-check-label" for="referralDiscount">Referral Discount (5% off)</label>
                </div>
                <div class="form-check mb-2">
                    <input class="form-check-input discount-check" type="checkbox" id="studentDiscount" onchange="handleDiscountCheckbox(this)">
                    <label class="form-check-label" for="studentDiscount">Student/Thesis Discount (10% off)</label>
                </div>
                <div class="form-check mb-3">
                    <input class="form-check-input discount-check" type="checkbox" id="planADiscount" onchange="handleDiscountCheckbox(this)">
                    <label class="form-check-label" for="planADiscount">
                        Plan A Discount (10% off)
                    </label>
                </div>
                
                <hr>

                <div class="result-box mt-3 bg-success text-white" id="discountResult">
                    Final Price: â‚±0
                </div>

                <ul class="list-group mt-3" id="discountBreakdown">
                    <li class="list-group-item">No calculations performed yet.</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<button id="discountButton" class="btn btn-warning" 
        data-bs-toggle="modal" data-bs-target="#discountModal" 
        onclick="prefillDiscountModal()">
    <i class="bi bi-wallet2"></i> Discount Tool
</button>

<script src="script.js"></script> 

</body>
</html>
